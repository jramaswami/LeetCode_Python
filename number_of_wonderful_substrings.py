"""
LeetCode
1915. Number of Wonderful Substrings
April 2024 Challenge
jramaswami

Thank You, Larry!
"""


import collections


class Solution:
    def wonderfulSubstrings(self, word: str) -> int:
        seen = collections.Counter()
        soln = 0
        seen[0] = 1
        curr_mask = 0
        for c in word:
            i = ord(c) - ord('a')
            m = (1 << i)
            curr_mask ^= m
            soln += seen[curr_mask]
            for j in range(10):
                t = (1 << j)
                x = curr_mask ^ t
                soln += seen[x]
            seen[curr_mask] += 1
        return soln


def test_1():
    word = "aba"
    expected = 4
    result = Solution().wonderfulSubstrings(word)
    assert expected == result


def test_2():
    word = "aabb"
    expected = 9
    result = Solution().wonderfulSubstrings(word)
    assert expected == result


def test_3():
    word = "he"
    expected = 2
    result = Solution().wonderfulSubstrings(word)
    assert expected == result


def test_4():
    word = "faecdbcjjbjccjgcadeeaeddbibjiiecggbchebffdchbdicacdbcgdchdgeciceghcdhfbdhcaagghhhjichcgfdaijicahcihgdejhdafjghhjjeaeajdbiheegghhbfgdidcbbfgbdihedfgghjejafdbeedadcagcfejaaihihfdgdedibiiaaaajeifcfcjeeahhcgidcigjhafibejcadaegbeejbficdjgcjfjcgefeifcijibdhaaccdigjeafcebjaiciicghbheifebdadhdeceidcaijihhecjcfcdagdjhfabejjaijajdeaehfghehggjhaidibdidggfghejbggcadhfgjfaeehhicbgjeibbhbijhfghiejadefebigahfeheageagejehgbfajjadicggiegbcbeigdjbcijagajgfaihedcfcjgibiicbjegjgadahdeefajjbajdhcchdeiediecefacdabeegedhcfbiefjagacbfbgbdhejieffhjhcifijjfbccdfgdhhjfbdcejefedgihdjcahaggcjdfafciecibacijddbebccefchjbjfhgeghbhgaacehebafbdghdjdjdbiajeaiiccifcdcjhiaadchfagjdbhfhhiddhaehcjeafediehghbjaafiicgfejadcahfdgagfadbaiehaeaaiifcbcegihfbiacaadjjgahibbfijdbhbcfhhgccihdahchdeeahjeabeiegdgjfdgdfabfiajhagfdhhjaafacaihiagacgijfjdfafehicbeaicafciegfbefehddbfbgfhdcdchabgdigbceeiegabggeiafejbbdgjgijdfjiibadgfjehhaehjdhcdghadeejdfaicjdajjbiachaiadcghjfbefhgdfagbjibjfhegcbeiiecaaifiidgidbcbgidfgibhjcgjcifaegfgbifcjdgddadgedhbeidgbagiddfbaedhjefgjgfdbcabjcigahfbjcjhdhccjjhhffjcbhjhaeaiifajhjcfaejehjabeeggfaebjeiaacaabijjbeiggjfbdfcfgjcebbehbhcjjggaefgbdhfaigaagfafegbbahfiaabijcffbjddjefcfhhdbbgdjiiabdeaihfccbbfdaifcjhidfijdjdbaebaibfcijhhcddachacfbgddfejeafeddjabbdgcfibgijbcjjijhagddidhhaijiafbaajgejihadjdcdjagbfghjabdhhbbicgceifddgbjeceejbigjfgdedeejbjhdibjghigegjigghghhedhdadgedgbhebedjgjbjjhfedgbhhaebgaeebiajijdhdcacffbfedcbdebidbhieijdcbcdfjgdejehbgecgjcdcfhihgajjggffbaaheiabbbebjcbhdhaajbhicibgajddceaaacgaighhbaacbcbdbdbfacgiaaaaaiedfhcgfgfhhgeeidhgghfbbaadfegchahjcebacbhibbbjbhechefigefhcdcagjjhbhfggjgejfaceeebfibaegfchdabdjgfdjjcacgiifcdcigcfjbegddafefaiaihcbdgdccgiijejdadehgibbagjeajafaggehdajahfcbadjibdgjjcigccbdeiadijejhcjiihcbjijgabhcjfgaiajjigefiddhjcbjjhijbbgbjjeffedffdefbdbhifcidajichgcdchafcfhffifgcfedgafgdhbcedafabhgaejbhdejadiagibiijbdeeggejigadcedbcfbbbcijhjdhdhjceecjjbbfbegegahefigfeahgjbeddaedeaefeehhdhbcdiafhediejdbgaicahgeedfcffjagfgccbbfaajadaeijegfffjiidhgiiadiecbhifeicigjegijecgdjihfbjabigfhbjeejbfghfddehechdjffdbadieibjdddeaejhgijhhihejjcibbaaagbihcagifcjhebhgcjdejgabjjabgbfbbigbjccggbegfcfebfbcjaffhgcjfadaeggcajbgegdejhbfjiehbfgacdgaedeicigeejjgfijjjcgdjaeiadgjhgcdjfgdeagfcfdaicffifgbfdjbebeeadcdbdihjfijiiehbchhbdbbjgcgaejcefacjahcgaeajajejehhbdadihbcjfihaejjbabegbiehjhiccdacjaacdgcbfabgfeifchacbegffhccdgihbbbdcjihibjbjjdbgcfjcehedfjfahajbcfbfdhcgbjdcacbbafejafdciideecfacdhcjdbaigcieghigjfhacfeaifjifchdiggijcfaihhbaifcfjiafhffebbdcfhhacgadhcdcfcieifiifdjhhgjjiicbjjjijahcjijehbghfbbigiaieheiehbdfagijaghhjbfgbbdiajiadbddhbcidahiejehcgcjdegfidhhhcebgfhcifagjdiigicdedfjcifdbcfejifcihjgjeggbfifgbeeejcjfadadafghhhgaifegcajffcceedaejbdidhjajhabigfbaegjiejgaihhahecfccefcfgdhgaaabeiibibgdcgdeajbbjceififfdebdjcigehdgdjbgajhjhigjifejjccheceabcgbafbibiibgiicefefhiceigjhijjafdeiafffgcacjdccadcbecieegfgbfdejiafdhdhhfcjhbfjbehdfdfgcbjijiiddcafaaedcacedfebcafhcibcghhcieihdjdgbeaddgdbjheedjgihffbcbiaccbcgibjgcfagjgcbhhbbaafagefgbfcfdfajecfdhdfjifbffcacfbeccdbfgieegefjdhgdffcfjfajafhggfdjhhfhabgdgfcjhjgjjgicahghegdjddabdiechjdcbaichjijbbgehfgadibgajgdebfgahiidibahabgbcbhfddgefjgjbhbjgjdhhfbccheibbfcebjciafgbgijchchedeahagbcbegjehjgfejhcgihcbiheggeehjcigbjebddcbbedfjieijjjbdafbcdhajchgbbhebeijgheaghjhfidceiediagjhggjchefdjfhbadihaaggdchfhfbdifbibbjahbfadihefeaedgcedgdffdjecdhbhfjebihfgfbcfgieedhcijcfgaiifedebbefbgbgaihiafgafbchggdbceeiiadcbgfbfedihbjidicifdjbggebcdcjbgjfabadfgifiiehfffdfbfidghdhjieiifehiccabechjhggfbcaeccghdchccjhchgcjhdehjjecfbfbgjbabjjdjcgadfaffiicgabheadagadhfchibdbdbfeghdhhcedghdfahcgcihaaaeabfbghijgbbbfjaejhidbaaefgeiihdgdfaeijihfifjdcdjjbjfifdbhdhgeiedfcfcecjeecjcaccjjedefabaaghfbcgdagbdbjggjgjgijcijbbbeddiahahhcbjieabehcjgajcihhdjbgjibbiidigjgifhdididaifcfadcghgfceidhicfegaacideifeighghaggdacdhaiaaffafgchgaffhfjhaddgiaigjefbeabgfeaaibabffiiadgfgcddhfiijahcdccichdeebajhfacajgcihhjccajfdehbaehbdfebcaafiahibjbchcfggicbddbhhbbcfghdehjijhggiidagebfdhaifeghajabbejcgcbigifbedgaagdcccagbeccifgfbdhaidddbdehcafbefcifjjiiibb"
    expected = 91067
    result = Solution().wonderfulSubstrings(word)
    assert expected == result


def test_5():
    "TLE"
    word = "cjcbjhieibjdhjediibjcihchgjafaaebdfedbhieeiefibfbfijcigijcjjabcbddhibjihihecdhdfdeihehcbejbiejaieebceddefdfcajhfdaaddccacjfhihhafgjbhfacbhfihiddjaadhbgabhjcjfbcciceaehicjafaeijaicfbdhbegdgeeiachifeggcbcbbifddbbdhiggfgebgfgjfcebbfecbaejihgbbbjajeaacggdighhgjhfcejiagecjefjcfageaebbdcafhhcjbdjbfebfdcdabgfdhhdjggehaajabbfbgbfhghihgidbifjbghifgajijccgabcgdaigdfeegeeihdebjbbdffchbfdfcjfjgihjafbdhbfcdcjcjcjjjdahbjcibiehaijegaeeahjhfiiaiececegeabgafgdehbecfahfecabgcbihgaghedjgjahagfihifgdbhfidfhdfefigdffachahihfgdaghbiigjgdhgbhjchifecgecafidahajhcffagcfiggbcdcchhieihciibechajhhgebiegdddjhdafidiiffhgieagfdfifgjadicacfajdhjeffeieebhfifcefahbcaihjcjababhbaejejahabgeiicgigaigiecfdfgjcfijfchiaiheccedcccgfjcjgbdghbjddcgdegidhacidhbiecahhdhhaiaddbhhghacddcjghcdighjchhihgjiaagggagjiibgfbdfjjcbiafecbhejjeifbciigaffhaagedhieejacjciihiddjgciicjgafidgjdfeffidehgjicaahagiadghjijaebeejijfhhgibjfbegdchibjbjbfhcabeggfadbdadghehacecbebiiifjeigeigjcbhhiejbajbfgbjaaieggbafgiefeiiibiaedicagfaegdcfegcaifcgecgjbahjeafachcidfgahjebciejbdddfjchbiahgdaaiibeiheiigbgeceifghedfbijbghgbgehgdejfjhcffacdeadeifhbcfieghjegjcjfggieghjdediahajijdfbcabcbdhefggbbdfchaceaediegicchgcahiechjefifhhiaehgcedhgaedadejjjbgacjejdgagjhjbfjefddfajhjacjejecbehcihfiacciidffecadjdjhfidacfddcbcagigadcahhjcbhdefbdegbihgdjjjbjhfgacjdfecfajjfbcfdcfhffehhdhfjfhehhghjceahahafhdcgacfgdajdcfehibhgeajigghajghiaefdiidfdjcejjbgfggbafceidfbadecjeeghiicbbejjbfcgfbgidfhfgjhdccichgedhbffadhaidbijjefjbefehfgbijbjfccfeadhbiacghgijfebdjjdgafdehgaajdhdfedhejahfihcfjfidffbgcejfgfgbgdegdejfffiedieaiiaifaiehfbgdajidcejfcbjiaahjbbgchaibddifcfifheefadegcfijbfdjbdigeajcabjdcigjgdeaagedbeaaiicggcbhgdfbdidegiegehfjjidijbcddfacffgdgdajabejbchhdfhdeijaafbehhcbcgdfihjciechiefjhebgedeafidjfaicjeahbbbfhjdcbeadehfccabjgagfbbejedfhcaheieiehhgfedjacghhcbbfecfbfiieafjeehdjfffdaagddhadeehhcbafgfjcghjedhhagdbcgijdcbcijbdaabafaiaffhgbgcfbefaacjdfciibeahdbhgajcaaihifgcchaahjhbbidhbdgdbfdhfbaajcbiiecjifjifdghfgefchgfgihcjebdghcdfhhfibehbfgggeeeifaigiagjifhhaeghhdeghbihhhdddediebihcbgifjcddibeagajfjaabhcdjjddafbfggiihdjihejfhcgagegehbhgeiefaiigeaaaafdaadgichbdaidjhcijegbhhbcgecfgbdecchbjeicaehfebigjbeaijfabgjcchigecbhbjbhghcjhifibhgechggeigjdjjdiafbcbhbccghgdjhhajacbhffhdggcihdhdbecdhegigehagbiheaghicgfceajbfihhhcedeghhihgccceeahigjddiaebaecagaibehidcaefbfdcgghjfjcgahbijchegjbbeaeegajghjdijibefeidiheabjjgfcgibbbhccjjhfadbffhcdfjjdggjaajdhdjefgdabcdcafjecbhjaicaacfejbgcheabdghfddchhgadbdddeaaaeiggcgifcijiabgehcefajdcijbieeiegcdhdiehfdjcgfjdjffjjcedcebbdbhfhcajbfiieigjcjcbiifcabhfibegffbdbdaecgbiedeggidcefcfgaagdjhiigidebiiaajfaffbbjabhhjaijgciaaijibcahcgbbjadcgjhgggcibijjifdadifgbeddjhcagjadifhaaedfjhebhbjjjadeajajfejgcebdhaiaaheibfaadhgjifacfabhacbjgaiiaidjegjbcfjcejjifjeihadibcfegcbhibhheejebfjbcaecebaajijehhffhfeccidcigdcfgdgeegafchjjfjbbgagdjfejfgdegfbbdgcjfdhgfhdhagefcabgjddhgefghfigjcehegcafhcdggcadifgjbjgdeibciaagedgdijifdibiccgjdgeahghfbjijjcjecaegdhbfdahdegeccigibeibgfggcacadedacadeijcdibadeibachieeabjjihfiiaifchgaebbbbcigfjceahhjfdifieagedejiadgihafhgdhgecahjhdbhejidicgegbfhicehhfeccjheeghagfcdcfjbjgjaeebbgccdjcjgjehfabjaafhgcgdjdddegibcbgafdaafddbfehfdgfcjgffddceehjaaaidjcjhfdcifgdgdfageaecheghgifebbjfbgbccgcfgbbgicjjcdajeiiijeeghigedecfeiggejahjadiddddijibgcgfedhicjegeahdibiafdehfgdfhhheacbjcichfdbidggaghacehifcgghfggbdjjhfdibidcaiefhjgecbgdieiibibfcihjgdefbgifebbjdhibidfjchjeegjcjdcgabgaceahiccaaiehbgdejfahebfiabddjaffbejjgcjfabdjedgjhggehfhidabdcaijbhcadhibabbhgfdbdffhhjdjebgagheaggehefajdghbdfgieaecihgajdjdjceafgecidecjfgeaiefbbhdbdheeagjjhfbfcagbdhcgfhihbibehbfibcifecgjbejagfgfighbigeefajhdgjeigcaceffchddajgijibgacbfcgbabcfhbhiafagcjhefiecjfcfjgbcbccjdffdbaihjfiabbgegfefaegaiahfcbfaaecdbgccbjiabbghcdbghahchiacdaijahfifffibdhfcffcgahbaegijegiijhehfhebedjdcgebeeedihffcfiggabihifbfhdhhegbagffffhgcbadabgfaiiaibafgiicjdfceedfeajdgijdbhcfdaciadeichbjdafgafbdjbbjhagegjfhbffibccaghjdbiffjfjfeaigccfjfbccfcidjbefifdgjgagbedcficfifhfgaaibgfhjigfhidfhgafaahicgbbidjgbdjbjebhadbhacbgjadhhbfahbjeiddjhhfccgcgaadcafjebghijbjdfaefiegafhdjfihdcicbhidfbjiefgdhfdabijaicfaahhceaajdfjcdeeafbgfjiahaeejhgficfgjegaieghajgjfcccefcggdbafihahgegehjghegfbbjdbeejihjeaeaaeeeiffggdibgadcbgbdhdefdhadcbiihbhjihjgjfdgfdgabiddcdbhcejjiaahhcfbdbcbbifhigbeiheedggggjaddfeegbjcbjbfibbehgeiegggbjegdfciicbeigeadgbafcbbadebjcfeiibidfhceeegjebbgddjgfcaagdhicicaehidefabiifaggibgbdfifhaihegeggbdibbgfhaffjhfjichfhajijdbafbeedeiiajgeiibceejdiiadhdaegbfhehjjceaiddiabaggedghfhdcfdjgejgcbggadfbebaaaddcfdgbeaaahibafiiebfbdjjgdggbaihehcjgghgcbjffijeihefbiiaejjafbfaddebihgefbgeeidbiibgidhjbgcegafficbgiaccbebahaadiabdjaadigdcbfhggiccgfdjiffehbedhadfjhighdedbaaaaghjadjfigjhgfbedbcbeeeiefeaideijgefehigdbgegdccehdajgafbdbadjcibfjgdeaaahhcfejaifijifdgdihficjfiehfhebdecggeebghddfhbcgbgaafgdbbfdfdgfahdiahjaajahjichhfcgdigbihjfeiefbchdbddcdcdedhigeebaafihcfddaiahaffjfjabchaibcjdghhgijaiaefeejhibjcedidffbdfjgehhagcecbddaijdgdddiiieajfgedefiehgfhjejcjadcdjbecjebbageajjijddbeeahahfijebhjaehaijdfcabeiiigfbecjffacbhicagbediejgicijafgbbiaehjdgjdijjadhhbfhfbieedfjbfaabceecjcfacfgiecfhichdhcgihgefcajchiddiifhaeihejdabebecbebijjjidfjcgacibhfecgjjedicfbafhfhdbbefechcjhjcgicaaecbjhabihahcdiibgjdjghejggjaibdccibbgehaabiibcdibjdadbefbjaaajagbdaabdhgacahaeabgcgijfjchbaeeabhdaiiiihbhghbajbhieejebbebeifccgieiadjaiddbbhfjfbdigicfiegjhfehidjefhaibcdeiiecgdecbhjjgdhbdjgdeigajfajiiieehgaaidgfbeefjgiebfdjdffgbddihchigdbafideiagejegiaifcgjdcjccbedgajdbbffagaahfgfifcfebbidgehbbafghadhcbegeieibajchhedhbacchgibfcfajcdgaijhghhgddcgihehaccghdidbiajfhahbihfecbeigcdideifehhgfifhhfjidifajbijjcgiejgdacfgicjedicddjighjiiajibjeghfegaagagfijidbaegididjfhggbecehfceifigcjhifjbfajjfhjjhgdiefdjhegjffehbdjifjcfbcacghicffbeahfjagaihheadfedgehafaidcacebdacfechaiidiefjedcdgfeaggdcgbghfgcfcgdaaijhdaedgaijeiadjbafccdhbccfdhffedjahgjfcbhbjbhafejbaadfhacdehabcafiijjehdjiajjcjiejcjhacieebjbcbgjfeageeacjeaihgbhdfefebdjajiggbcjijicffcigebcihaddjhabfgeeacefacgbagbaggjeajajeegeehahfgaihhejifcgeeddhddjcdbfhfebfadihjhghijggdbifeigcgcbagcihifaejabijaidgaficdaheaghgajfbgjgbcgcadgeeegiajejbcaihjffecdagibecafgadbjfbiddafeggjgfbfbegighhjdjgichebihifeigijfdecghcicajdigejcbgjhaigajcediachjabgjjfhdjehggbfdhhcbhfbcfiicjjdihdejcihdebadjhihdihdchcahgcgigabgfhcabahdfddefgffhhbehijgfcfedhdghghfajhghjbafgediiiadbbedhjbfajiciiibcegbhggebjigchecbidcdeagebfahfbaigecjegaaagcecgajfgifeejgegbidfdaedhahabgfejiibdcijhcjeecifhajffjhaagijaceehjhaegejaebccfeddiihiaajhgdhaijagfajfeaihcgejgffdiaeajedbeafgbdeccbaffjbddggbgfbfjicccchebjcgbbhficebbieicaaadfdehhhhdeeehgiddfahbageacbcibddibjihifcahebfifjbcaiiicehfeagedebjjgheijihdchedbhgiejjjjfifcbaagfffifbgfaecidcdddjbacdcgcjefaahaccgdhhbdhabdfgghebhcbhadehbfdfffchjbfeefefdeeehggjdabccicgeeahfdgfdfhfgbdahjecdebibdjcaihgcejhbagfbiajfiafahjedahdceiccbhfeigcechcagifgjbdhddfefhiibdbebjegchcecdhejjbhbibjicbcgbadjdfcacdajdgfddihijhechccabdijiehbjfhhedagihajfgahbgbjcfjbdhbcbebfiegiigjfdhaejhjbdcadgbcfjffgfhgfdjjfcbhagfcifaijjcbjfggfgghfibcgfijghfibdhbfghjgghjgbcfedhhabcdeieigjghbhefiffcajeahijijbageichjdcccfaaedbhiiiijjfhgjadajjdgbehfhdhfbdhhgdgefefcfebgbhjfedcejhcgfciefcjbbdhhcjhhjiidabadbjgajaifcdebicgcibjibbidiccbciehbbcjcaeeiehgjbacagbjadfdhjicacbcahcjcjdjdibhjhbdgddbhefcfghfhaagcdbecabjbecabhhjdgebfggdbbehgfjggjjbfigjggeeficcjbcedaeibfieghjccegiiehahjbeeibfaebjdhijhafiijibecaeebfacachjdhacihbfadaibjhgheiihcbjaedahcjghiaejajccjgifedjhdddfdjgiehbgjdjccdchhdbddefcjjfbhdafabbedcjahdhgejjghcghgjhedccdjfdgabafbcaajbiajhcddeahjijdhdgbaicdjaefbjffejabccejddgdecibciebjfcheiadidchaeiijdddgdhjbefjjicfghfhecjgfdfcgiabadbiejgjjgdajeabhhhgbdidgeibifjjcaabjcfgaejjibcgieeidahfjhcgbbfcjhjfbaahafchadbgjcihhgeaedchehjjifafbhjddiafichddgcefcejjhhfcbcdcjfghaaigehafhhaeecbiicbeicbfifabcbadjcijgdjgdjbjiefbabagificeheiaedeaajcdijdgcgffhhghfddhaidacbjhghebbbibeagcfjagdacgjfahfebcbediaigeiigcfebjdeehfdeccgihbjhjiddcjaijdjjahifhijijabcagjcjgjbbebghihhcgggdaciabghfgjbdhbbccccjggfaahhdadafabgfbaahbfedbbedcdhggfaciadjeffejefhjdchegdhhajbbbidfaegbjdcbaccfaefiehcajaffhcbbicihhgiifcebdefhbdeggdjjeibefbejhgdafjdahibgcfcjiidgdehachfjgdaegbhjbhehiacjdeggecfeddbaebgcfaffahgadjcajbbadadjeebhdfaeijcjejaefjhacaaedihfbifcadfeiificfiaihchfiiiagdfhfacacdddfbdagdacbjhdegcidihfcbdcggeiecdcfedahjehcedgcebgddjhbgchdceijeiecahcbbffaegeijbdigjfhbdcceibiahfcaegegfgjfcdjjcchjjfaibdihfcicdadhjgjaecbbjaccigigcihghigbiejaifjhdahbcicjiajeffcafhdjfddfddficfjieceagadcadgbbibdhhbdffibiighehaihjdbcieabgcfgdiaifffifheffjjgaebaafhhjbbgdcgbgehcigihdccibhjhefhifdcdachcgdhjbbhddjbgffaefdjggicicaffijhfeggajjjfdhifgajcbcbjhdjdfgihjjbggabifejgbddcgeaabbbafhjcccijfaaccgdebjebcdeifbhjeacibjiagaacjbddgijdidgbagbdfchgffdcgagecegabiaeijdiegaihhcgebecfbbccgeafifadedihchgiaagheejfdgjegahdidfjdgdigijhhiieajghbjfejajfifggfagcfabccdghbgfdfddhifaaadjdfibafdigchbdcfiihagfgabcigbbhbjecgfjccdfiehjaahbadhbdbejabhjehjjafjgbbacbgidhhfajjabaifjedjhegdagcfagjhjadehfedehhjbaefgbdicehbdjdh"
    expected = 430703
    result = Solution().wonderfulSubstrings(word)
    assert expected == result